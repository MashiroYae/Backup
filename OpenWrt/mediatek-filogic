#!/usr/bin/env bash

Target=mediatek
Arch=filogic

cd /srv/http/OpenWrt/ImageBuilder || exit
rm -rf openwrt-imagebuilder-$Target-$Arch.Linux-x86_64
curl -JLO https://downloads.openwrt.org/snapshots/targets/$Target/$Arch/openwrt-imagebuilder-$Target-$Arch.Linux-x86_64.tar.xz
tar xf openwrt-imagebuilder-$Target-$Arch.Linux-x86_64.tar.xz
rm openwrt-imagebuilder-$Target-$Arch.Linux-x86_64.tar.xz
cd openwrt-imagebuilder-$Target-$Arch.Linux-x86_64 || exit

make -j$(nproc) image PROFILE=bananapi_bpi-r3 PACKAGES="apcupsd apcupsd-cgi auc avahi-daemon-service-http avahi-daemon-service-ssh avahi-dbus-daemon blockd btrfs-progs cfdisk cifsmount curl dnsmasq-full dosfstools fdisk ip-full iw-full kmod-fs-msdos kmod-fs-nfs-v4 kmod-nvme kmod-usb-net-cdc-subset kmod-usb-storage-extras kmod-usb-storage-uas ksmbd-avahi-service libgd-full lsblk lsd luci luci-app-attendedsysupgrade luci-app-irqbalance luci-app-ksmbd luci-app-nut luci-app-usteer luci-proto-wireguard luci-ssl-openssl nano-full nfs-kernel-server-utils nfs-utils nut-avahi-service nut-driver-apcupsd-ups nut-web-cgi nvme-cli openssh-sftp-avahi-service pciutils qrencode rsync usbutils wget-ssl wpad-openssl -dnsmasq -libustream-mbedtls -odhcp6c -odhcpd-ipv6only -ppp -ppp-mod-pppoe -wpad-basic-mbedtls"
make -j$(nproc) image PROFILE=bananapi_bpi-r3-mini PACKAGES="auc avahi-daemon-service-http avahi-daemon-service-ssh avahi-dbus-daemon blockd btrfs-progs cfdisk cifsmount curl dnsmasq-full dosfstools fdisk ip-full iw-full kmod-fs-msdos kmod-fs-nfs-v4 kmod-mtd-rw kmod-nvme kmod-usb-net-cdc-subset kmod-usb-storage-extras kmod-usb-storage-uas ksmbd-avahi-service lsblk lsd luci luci-app-attendedsysupgrade luci-app-irqbalance luci-app-ksmbd luci-app-usteer luci-proto-wireguard luci-ssl-openssl nano-full nfs-kernel-server-utils nfs-utils nvme-cli openssh-sftp-avahi-service pciutils qrencode rsync usbutils wget-ssl wpad-openssl -dnsmasq -libustream-mbedtls -odhcp6c -odhcpd-ipv6only -ppp -ppp-mod-pppoe -wpad-basic-mbedtls"
make -j$(nproc) image PROFILE=bananapi_bpi-r4 PACKAGES="auc avahi-daemon-service-http avahi-daemon-service-ssh avahi-dbus-daemon blockd btrfs-progs cfdisk cifsmount curl dnsmasq-full dosfstools fdisk ip-full iw-full kmod-fs-msdos kmod-fs-nfs-v4 kmod-nvme kmod-usb-net-cdc-subset kmod-usb-storage-extras kmod-usb-storage-uas ksmbd-avahi-service lsblk lsd luci luci-app-attendedsysupgrade luci-app-irqbalance luci-app-ksmbd luci-app-usteer luci-proto-wireguard luci-ssl-openssl nano-full nfs-kernel-server-utils nfs-utils nvme-cli openssh-sftp-avahi-service pciutils qrencode rsync usbutils wget-ssl wpad-openssl -dnsmasq -libustream-mbedtls -odhcp6c -odhcpd-ipv6only -ppp -ppp-mod-pppoe -wpad-basic-mbedtls"
make -j$(nproc) image PROFILE=glinet_gl-mt3000 PACKAGES="auc avahi-daemon-service-http avahi-daemon-service-ssh avahi-dbus-daemon blockd btrfs-progs cfdisk cifsmount curl dnsmasq-full dosfstools fdisk ip-full iw-full kmod-fs-msdos kmod-fs-nfs-v4 kmod-usb-net-cdc-subset kmod-usb-storage-extras kmod-usb-storage-uas ksmbd-avahi-service lsblk lsd luci luci-app-attendedsysupgrade luci-app-irqbalance luci-app-ksmbd luci-app-usteer luci-proto-wireguard luci-ssl-openssl nano-full nfs-kernel-server-utils nfs-utils openssh-sftp-avahi-service qrencode rsync usbutils wget-ssl wpad-openssl -dnsmasq -libustream-mbedtls -odhcp6c -odhcpd-ipv6only -ppp -ppp-mod-pppoe -wpad-basic-mbedtls"
make -j$(nproc) image PROFILE=glinet_gl-mt6000 PACKAGES="auc avahi-daemon-service-http avahi-daemon-service-ssh avahi-dbus-daemon blockd btrfs-progs cfdisk cifsmount curl dnsmasq-full dosfstools fdisk ip-full iw-full kmod-fs-msdos kmod-fs-nfs-v4 kmod-usb-net-cdc-subset kmod-usb-storage-extras kmod-usb-storage-uas ksmbd-avahi-service lsblk lsd luci luci-app-attendedsysupgrade luci-app-irqbalance luci-app-ksmbd luci-app-usteer luci-proto-wireguard luci-ssl-openssl nano-full nfs-kernel-server-utils nfs-utils openssh-sftp-avahi-service qrencode rsync usbutils wget-ssl wpad-openssl -dnsmasq -libustream-mbedtls -odhcp6c -odhcpd-ipv6only -ppp -ppp-mod-pppoe -wpad-basic-mbedtls"
make -j$(nproc) image PROFILE=xiaomi_mi-router-ax3000t-ubootmod PACKAGES="auc avahi-daemon-service-http avahi-daemon-service-ssh avahi-dbus-daemon blockd cifsmount curl dnsmasq-full ip-full iw-full kmod-fs-nfs-v4 kmod-mtd-rw lsblk lsd luci luci-app-attendedsysupgrade luci-app-irqbalance luci-app-usteer luci-proto-wireguard luci-ssl-openssl nano-full nfs-utils openssh-sftp-avahi-service qrencode rsync wget-ssl wpad-openssl -dnsmasq -libustream-mbedtls -odhcp6c -odhcpd-ipv6only -ppp -ppp-mod-pppoe -wpad-basic-mbedtls"
make -j$(nproc) image PROFILE=xiaomi_redmi-router-ax6000-ubootmod PACKAGES="auc avahi-daemon-service-http avahi-daemon-service-ssh avahi-dbus-daemon blockd cifsmount curl dnsmasq-full ip-full iw-full kmod-fs-nfs-v4 kmod-mtd-rw lsblk lsd luci luci-app-attendedsysupgrade luci-app-irqbalance luci-app-usteer luci-proto-wireguard luci-ssl-openssl nano-full nfs-utils openssh-sftp-avahi-service qrencode rsync wget-ssl wpad-openssl -dnsmasq -libustream-mbedtls -odhcp6c -odhcpd-ipv6only -ppp -ppp-mod-pppoe -wpad-basic-mbedtls"
